<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Google Sheets Form</title>
    <script>
      async function handleSubmit(event) {
        event.preventDefault();

        const formData = {
          message: document.getElementById("msg").value,
        };
        console.log(formData, typeof formData);

        try {
          const response = await fetch(
            "https://script.google.com/macros/s/AKfycbz3CZ_cPA_St_bDrUHmTC6mCJvzzOcX3jic7OSBudMXKtsVkTpaeb18OfQ4KdeXIspp/exec",
            {
              method: "POST",
              body: JSON.stringify(formData),
              headers: { "Content-Type": "application/json" },
            }
          );

          const result = await response.json();
          alert("성공적으로 저장되었습니다! 행 번호: " + result.row);
        } catch (error) {
          alert("오류 발생: " + error);
        }
      }
    </script>
  </head>
  <body>
    <h2>Google Sheets Form</h2>
    <form
      action="https://script.google.com/macros/s/AKfycbz3CZ_cPA_St_bDrUHmTC6mCJvzzOcX3jic7OSBudMXKtsVkTpaeb18OfQ4KdeXIspp/exec"
      method="post"
    >
      <label>메시지:</label><br />
      <textarea rows="4" cols="40"></textarea><br /><br />

      <button type="submit">제출</button>
    </form>
  </body>
</html>
